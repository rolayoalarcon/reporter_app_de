"0","n_chosen_patterns <- sum(x[x$selected==""chosen"", ""n_patterns""])"
"0","n_chosen_genes <- sum(x[x$selected==""chosen"", ""ngenes_in_npatterns""])"
"0",""
"0","annotation <- paste0(""There are "", n_chosen_patterns, "" patterns with at least "", min_g, "" genes\n ("", n_chosen_genes, "" genes represented)"")"
"0",""
"0","ggplot(x, aes(x=n_genes_fctr, y=n_patterns_log, fill=selected)) +"
"0","    geom_bar(stat=""identity"", color=""black"") + "
"0","  geom_text(aes(label=n_patterns), vjust=-0.3, size=3) +"
"0","  scale_fill_manual(values=c(alpha(""red"", 0.5), alpha(""grey"", 0.5))) +"
"0","  annotate(""text"", x=19, y=9, label=annotation) +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""none"") +"
"0","  labs(x=""Number of genes with a given pattern"", y=""log2( Number of Patterns with N genes )"")"
