"0","selected.patterns <- patter.db %>% "
"0","  filter(n_genes >= min_g)"
"0",""
"0","selected.patterns %>% "
"0","  mutate(""Ctrl"" = 0) %>% "
"0","  gather(As, Bs, Hyp, Li, Nd, Ns, Oss, Oxs, Sp, Tm, Vic, Ctrl, "
"0","         key = ""condition"", value=""DE"") %>% "
"0","  mutate(condition = factor(condition, levels=c(""Ctrl"",""As"", ""Bs"", ""Hyp"", ""Li"", ""Nd"", ""Ns"", ""Oss"", ""Oxs"", ""Sp"", ""Tm"", ""Vic"")),"
"0","         DE_fctr=factor(DE, levels = c(1,0,-1))) %>% "
"0","  ggplot(aes(x=condition, y=DE, group=pattern_id, color=DE_fctr)) +"
"0","  geom_line(color=alpha(""black"", 0.75)) +"
"0","  geom_point() +"
"0","  scale_color_manual(values=c(""#ef8a62"", ""grey"", ""#67a9cf"")) +"
"0","  facet_wrap(~ patid_ngenes) +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""none"","
"0","        axis.text.x = element_text(angle = 90)) +"
"0","  labs(x=""Condition"", y=""Direction of Differential Expression"","
"0","       title=""Differential Expression Patterns"")"
