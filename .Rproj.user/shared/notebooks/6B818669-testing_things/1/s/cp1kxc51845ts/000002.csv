"0","joint_de.cds <- joint_de %>% "
"0","  filter(`# feature` == ""CDS"")"
"0","pattern_count <- plyr::ddply(joint_de.cds, plyr::.(As, Bs, Hyp, Li, Nd, Ns, Oss, Oxs, Sp, Tm, Vic), nrow)"
"0",""
"0",""
"0","min_g <- 15"
"0","x <- pattern_count %>% "
"0","  count(V1) %>% "
"0","  rename(n_genes=V1,"
"0","         n_patterns = n) %>% "
"0","  mutate(n_genes_fctr = factor(n_genes, levels = 1:max(n_genes)),"
"0","         n_patterns_log = log2(n_patterns),"
"0","         selected=if_else(n_genes >= min_g, ""chosen"", ""not_chosen""),"
"0","         ngenes_in_npatterns = n_genes * n_patterns)"
