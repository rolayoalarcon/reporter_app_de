br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br())
), # end of pattern wrap
sidebarLayout(
sidebarPanel(
selectInput(inputId = "color_by_cds",
label = "Color genes according to:",
choices = list("organism",
"Salmonella pre-selection",
"Campylobacter pre-selection",
"Transcription Factors"))
), # end of sidebar gene wrap
mainPanel(plotOutput("gene_wrap.cds"), height="750px",
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br())
), # end of gene wrap
sidebarLayout(
sidebarPanel(
textInput(inputId = "pattern_interest_cds",
label = "Focus on this pattern",
value = "Pattern 1"),
selectInput(inputId = "organism_interest_cds",
label = "Show:",
choices = c("Both organisms", "Only Salmonella", "Only Campylobacter")),
textInput(inputId = "gene_interest_cds",
label="Highlight Gene (if more than one, separate with comma)",
value = "None"),
actionButton(inputId="focus_param_cds",
label = "Submit")
),# end of focus sidebar
mainPanel(plotlyOutput("focus_pattern_cds"),
br(),
br(),
br(),
plotOutput("focuse_de_cds"),
DTOutput("cluster_members_cds"),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br())
), #end of focus
"All Genes",
DTOutput("all_cds_table")
), # End of CDS tab
tabPanel(title = "sRNA",
sidebarLayout(
sidebarPanel(
textInput(inputId = "selcond.srna",
label = "Conditions to evaluate",
value = "As,Bs,Hyp,Li,Nd,Ns,Oss,Oxs,Sp,Tm,Vic"),
selectInput(inputId = "de.direction.srna",
label = "Group genes by:",
choices = list("Upregulation and Downregulation"="up_dw",
"Only Upregulation" = "o_up")),
numericInput(inputId = "fdr.srna",
label="False Discovery Rate",
value=0.05,
min=0,
max=1), # FDR input
numericInput(inputId = "fc.srna",
label="Minimum Absolute Fold Change",
value=0,
min=0), # fcmin
numericInput(inputId = "min_genes.srna",
label="Minimum Number of genes per pattern",
value=5,
min=1), # min genes input
actionButton(inputId = "pattern_param_srna",
label = "Submit", icon = NULL, width = NULL)
), #pattern sidebar
mainPanel(plotOutput("pattern_freq.srna"))
), # end of FDR and min genes sidebar
sidebarLayout(
sidebarPanel(
numericInput(inputId = "min_genes_wrap.srna",
label="Minimum Number of genes per pattern",
value = 5,
min=1),
actionButton(inputId = "wrap_param.srna",
label="Submit")
), # end of sidebar pattern wrap
mainPanel(plotOutput("pattern_wrap.srna"), height="750px",
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br())
), # end of pattern wrap
sidebarLayout(
sidebarPanel(
selectInput(inputId = "color_by_srna",
label = "Color genes according to:",
choices = list("organism",
"Salmonella pre-selection",
"Campylobacter pre-selection"))
), # end of sidebar gene wrap
mainPanel(plotOutput("gene_wrap.srna"), height="750px",
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br())
), # end of gene wrap
sidebarLayout(
sidebarPanel(
textInput(inputId = "pattern_interest_srna",
label = "Focus on this pattern",
value = "Pattern 1"),
selectInput(inputId = "organism_interest_srna",
label = "Show:",
choices = c("Both organisms", "Only Salmonella", "Only Campylobacter")),
textInput(inputId = "gene_interest_srna",
label="Highlight Gene (if more than one, separate with comma)",
value = "None"),
actionButton(inputId="focus_param_srna",
label = "Submit")
),# end of focus sidebar
mainPanel(plotlyOutput("focus_pattern_srna"),
br(),
br(),
br(),
plotOutput("focuse_de_srna"),
DTOutput("cluster_members_srna"),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br(),
br())
), #end of focus
"All Genes",
DTOutput("all_srna_table")
) # end of sRNA
) #end of tabset
)
# Reading in expression data
combined_de <- read_tsv("data/de_results_combined.tsv.gz")
setwd("reporter_selection_de/")
library(shiny)
library(plotly)
library(DT)
library(readxl)
source("scritps/helpers.R")
library(tidyverse)
# Reading in expression data
combined_de <- read_tsv("data/de_results_combined.tsv.gz")
# Read genomic info
genomic_features <- read_tsv("data/genomic_features.tsv.gz")
cds.adjust.de <- apply_correction(combined_de, 0.05, 0, "o_up")
cds.adjust.de
cds.de_patterns <- gather_patterns(cds.adjust.de, genomic_features, c("CDS"), c("As","Bs", "Hyp", "Li",  "Nd",  "Ns",  "Oss", "Oxs", "Sp",  "Tm",  "Vic"))
pattern.database.cds <- create_pattern_database(cds.de_patterns, c("As","Bs", "Hyp", "Li",  "Nd",  "Ns",  "Oss", "Oxs", "Sp",  "Tm",  "Vic"))
collective_df.cds <- combine_patterns_and_fc(pattern.database.cds, cds.de_patterns, cds.adjust.de, c("As","Bs", "Hyp", "Li",  "Nd",  "Ns",  "Oss", "Oxs", "Sp",  "Tm",  "Vic"))
collective_df.cds
head(collective_df.cds)
collective_df.cds$pgfam_id
collective_df.cds
collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id)
collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id))
collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>% distinct()
collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella"))
campy_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
select(-organism)
salm_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
select(-organism)
salm_pfam
campy_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
select(-organism)
salm_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
select(-c(organism, pgfam_genes))
salm_pfam
campy_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
select(-c(organism, pgfam_genes)) %>%
rename(camp_pattern = pattern_id)
salm_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
select(-c(organism, pgfam_genes)) %>%
rename(salm_pattern = pattern_id)
salm_pfam
campy_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
select(-c(organism, pgfam_genes)) %>%
rename(camp_pattern = pattern_id,
cjejuni_loctag = locus_tag)
salm_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
select(-c(organism, pgfam_genes)) %>%
rename(salm_pattern = pattern_id,
salmonella_loctag = locus_tag)
salm_pfam
camp_pfam %>%
left_join(salm_pfam, by="pgfam_id")
campy_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
select(-c(organism, pgfam_genes)) %>%
rename(camp_pattern = pattern_id,
cjejuni_loctag = locus_tag)
salm_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
select(-c(organism, pgfam_genes)) %>%
rename(salm_pattern = pattern_id,
salmonella_loctag = locus_tag)
campy_pfam %>%
left_join(salm_pfam, by="pgfam_id")
campy_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
select(-c(organism, pgfam_genes)) %>%
rename(camp_pattern = pattern_id,
cjejuni_loctag = locus_tag)
salm_pfam <- collective_df.cds %>%
select(locus_tag, pgfam_id, pgfam_genes, pattern_id) %>%
filter(!is.na(pgfam_id)) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
select(-c(organism, pgfam_genes)) %>%
rename(salm_pattern = pattern_id,
salmonella_loctag = locus_tag)
campy_pfam %>%
left_join(salm_pfam, by="pgfam_id") %>%
filter(!is.na(salmonella_loctag))
campy_pfam %>%
left_join(salm_pfam, by="pgfam_id") %>%
filter(!is.na(salmonella_loctag)) %>%
filter(camp_pattern == salm_pattern)
campy_pfam %>%
left_join(salm_pfam, by="pgfam_id") %>%
filter(!is.na(salmonella_loctag)) %>%
filter(camp_pattern == salm_pattern) %>%
filter(camp_pattern != 0)
campy_pfam %>%
left_join(salm_pfam, by="pgfam_id") %>%
filter(!is.na(salmonella_loctag)) %>%
filter(camp_pattern == salm_pattern) %>%
filter(camp_pattern != "Pattern 0")
campy_pfam %>%
left_join(salm_pfam, by="pgfam_id") %>%
filter(!is.na(salmonella_loctag)) %>%
filter(camp_pattern == salm_pattern) %>%
filter(camp_pattern != "Pattern 0") %>%
arrange(camp_pattern)
collective_df.cds
collective_df.cds %>%
filter(!is.na(bbh))
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id)
#17,248
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
mutate(organism=if_else(startsWith("CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter")
#17,248
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter")
#17,248
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella")
#17,248
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella")
#17,248
#783
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter")
#17,248
#783
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
rename(cjejuni_loctag=locus_tag,
salmonella_loctag=bbh,
cjejuni_pattern=pattern_id) %>%
select(-organism)
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella")
collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
rename(salmonella_loctag=locus_tag,
salmonella_pattern=pattern_id) %>%
select(-organism)
#17,248
#783
bbh_info <- collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
rename(cjejuni_loctag=locus_tag,
salmonella_loctag=bbh,
cjejuni_pattern=pattern_id) %>%
select(-organism)
salm_info <- collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
rename(salmonella_loctag=locus_tag,
salmonella_pattern=pattern_id) %>%
select(-organism)
bbh_info %>%
left_join(salm_info, by="salmonella_loctag")
bbh_info %>%
left_join(salm_info, by="salmonella_loctag") %>%
filter(cjejuni_pattern == salmonella_pattern)
bbh_info %>%
left_join(salm_info, by="salmonella_loctag") %>%
filter(cjejuni_pattern == salmonella_pattern) %>%
filter(cjejuni_pattern != "Pattern 0")
#17,248
#783
bbh_info <- collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, bbh, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Campylobacter") %>%
rename(cjejuni_loctag=locus_tag,
salmonella_loctag=bbh,
cjejuni_pattern=pattern_id) %>%
select(-organism)
salm_info <- collective_df.cds %>%
filter(!is.na(bbh)) %>%
select(locus_tag, pattern_id) %>%
distinct() %>%
mutate(organism=if_else(startsWith(locus_tag, "CJJ"), "Campylobacter", "Salmonella")) %>%
filter(organism == "Salmonella") %>%
rename(salmonella_loctag=locus_tag,
salmonella_pattern=pattern_id) %>%
select(-organism)
bbh_info %>%
left_join(salm_info, by="salmonella_loctag") %>%
filter(cjejuni_pattern == salmonella_pattern) %>%
filter(cjejuni_pattern != "Pattern 0") %>%
arrange(cjejuni_pattern)
runApp()
runApp()
runApp()
runApp()
