shiny::runApp('~/Documents/reporter_selection_app')
runApp('~/Documents/reporter_selection_de')
runApp()
library(shiny)
runUrl("https://github.com/rolayoalarcon/reporter_app_de/raw/main/reporter_selection_de.zip")
runApp()
library("conflicted")
library(tidyverse)
library(DESeq2)
shiny::runApp()
runApp()
library(shiny)
runUrl("https://github.com/rolayoalarcon/reporter_app_de/raw/main/reporter_selection_de.zip")
shiny::runApp()
runApp('~/Documents/reporter_selection_app')
runApp()
runApp('~/Documents/reporter_selection_app')
runApp()
runApp()
setwd("../reporter_selection_de/")
# Reading in genomic features
salm_features <- read_tsv("data/merged_features_salmonella.tsv") %>%
mutate(organism="Salmonella",
gene_name=paste0(locus_tag, "-Salmonella")) %>%
select(gene_name, `# feature`, symbol)
camp_features <- read_tsv("data/merged_features_campylobacter.tsv") %>%
mutate(organism="Campylobacter",
gene_name=paste0(locus_tag, "-Campylobacter")) %>%
select(gene_name, `# feature`, symbol)
genomic_features <- bind_rows(camp_features, salm_features)
View(genomic_features)
# Reading in genomic features
salm_features <- read_tsv("data/merged_features_salmonella.tsv") %>%
mutate(organism="Salmonella",
gene_name=paste0(locus_tag, "-Salmonella")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
camp_features <- read_tsv("data/merged_features_campylobacter.tsv") %>%
mutate(organism="Campylobacter",
gene_name=paste0(locus_tag, "-Campylobacter")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
genomic_features <- bind_rows(camp_features, salm_features)
# Reading TF info
camp_tf <- read_tsv("data/cjj_TFs.tsv")
View(camp_tf)
salm_tf <- read_tsv("data/sey_TFs.tsv")
joint_tfs <- bind_rows(camp_tf, salm_tf)
View(joint_tfs)
genomic_features <- genomic_features %>%
mutate("TF" = if_else(locus_tag %in% joint_tfs$locus_tag, "TF", "-"))
joint_tfs <- bind_rows(camp_tf, salm_tf) %>%
select(locus_tag, tf_name, family, subtype)
genomic_features <- genomic_features %>%
left_join(joint_tfs, by="locus_tag")
# Adding pre-selected info to genomic features
salm.preselection <- read_tsv("data/pre_selected_salmonella.txt") %>%
rename("symbol"=ID) %>%
left_join(genomic_features, by="symbol") %>%
select(gene_name)
camp.preselection <- read_excel("data/Campy regulators and stress resp for Roberto.xlsx") %>%
rename("locus_tag" = `Locus tag 81-176`,
clone=`clone?`) %>%
mutate("gene_name" = paste0(locus_tag, "-Campylobacter"),
clone=if_else(is.na(clone), "No", "Yes"))
all_preselected <- c(salm.preselection$gene_name, camp.preselection$gene_name)
campy.clone <-  subset(camp.preselection, clone=="Yes")$gene_name
genomic_features <- genomic_features %>%
mutate("pre.selected" = if_else(gene_name %in% all_preselected, "Yes", "-"),
"campy.clone" = if_else(gene_name %in% campy.clone, "Yes", "-"))
View(genomic_features)
subset(genomic_features, TF=="TF" & pre.selected == "Yes")
runApp()
runApp()
runApp()
# Reading AMR
camp_amr <- read_tsv("data/cjj_AMR.tsv")
salm_amr <- read_tsv("data/sey_AMR.tsv")
joint_amr <- bind_rows(camp_amr, salm_amr)
genomic_features <- genomic_features %>%
mutate("ARG_gene" = if_else(locus_tag %in% joint_amr$locus_tag, "ARG", "-"))
View(genomic_features)
runApp()
runApp()
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv")
View(campy_loctags)
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje)
genomic_features <- genomic_features %>%
left_join(campy_loctags, by="locus_tag")
View(genomic_features)
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168)
genomic_features <- genomic_features %>%
left_join(campy_loctags, by="locus_tag")
# Reading in genomic features
salm_features <- read_tsv("data/merged_features_salmonella.tsv") %>%
mutate(organism="Salmonella",
gene_name=paste0(locus_tag, "-Salmonella")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
camp_features <- read_tsv("data/merged_features_campylobacter.tsv") %>%
mutate(organism="Campylobacter",
gene_name=paste0(locus_tag, "-Campylobacter")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
genomic_features <- bind_rows(camp_features, salm_features)
# Reading TF info
camp_tf <- read_tsv("data/cjj_TFs.tsv")
salm_tf <- read_tsv("data/sey_TFs.tsv")
joint_tfs <- bind_rows(camp_tf, salm_tf) %>%
select(locus_tag, tf_name, family, subtype)
genomic_features <- genomic_features %>%
mutate("TF" = if_else(locus_tag %in% joint_tfs$locus_tag, "TF", "-"))
genomic_features <- genomic_features %>%
left_join(joint_tfs, by="locus_tag")
# Reading AMR
camp_amr <- read_tsv("data/cjj_AMR.tsv")
salm_amr <- read_tsv("data/sey_AMR.tsv")
joint_amr <- bind_rows(camp_amr, salm_amr)
genomic_features <- genomic_features %>%
mutate("ARG_gene" = if_else(locus_tag %in% joint_amr$locus_tag, "ARG", "-"))
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168)
genomic_features <- genomic_features %>%
left_join(campy_loctags, by="locus_tag")
# Adding pre-selected info to genomic features
salm.preselection <- read_tsv("data/pre_selected_salmonella.txt") %>%
rename("symbol"=ID) %>%
left_join(genomic_features, by="symbol") %>%
select(gene_name)
camp.preselection <- read_excel("data/Campy regulators and stress resp for Roberto.xlsx") %>%
rename("locus_tag" = `Locus tag 81-176`,
clone=`clone?`) %>%
mutate("gene_name" = paste0(locus_tag, "-Campylobacter"),
clone=if_else(is.na(clone), "No", "Yes"))
all_preselected <- c(salm.preselection$gene_name, camp.preselection$gene_name)
campy.clone <-  subset(camp.preselection, clone=="Yes")$gene_name
genomic_features <- genomic_features %>%
mutate("pre.selected" = if_else(gene_name %in% all_preselected, "Yes", "-"),
"campy.clone" = if_else(gene_name %in% campy.clone, "Yes", "-"))
runApp()
runApp()
# Reading in genomic features
salm_features <- read_tsv("data/merged_features_salmonella.tsv") %>%
mutate(organism="Salmonella",
gene_name=paste0(locus_tag, "-Salmonella")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
camp_features <- read_tsv("data/merged_features_campylobacter.tsv") %>%
mutate(organism="Campylobacter",
gene_name=paste0(locus_tag, "-Campylobacter")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
genomic_features <- bind_rows(camp_features, salm_features)
# Reading TF info
camp_tf <- read_tsv("data/cjj_TFs.tsv")
salm_tf <- read_tsv("data/sey_TFs.tsv")
joint_tfs <- bind_rows(camp_tf, salm_tf) %>%
select(locus_tag, tf_name, family, subtype)
genomic_features <- genomic_features %>%
mutate("TF" = if_else(locus_tag %in% joint_tfs$locus_tag, "TF", "-"))
genomic_features <- genomic_features %>%
left_join(joint_tfs, by="locus_tag")
# Reading AMR
camp_amr <- read_tsv("data/cjj_AMR.tsv")
salm_amr <- read_tsv("data/sey_AMR.tsv")
joint_amr <- bind_rows(camp_amr, salm_amr)
genomic_features <- genomic_features %>%
mutate("ARG_gene" = if_else(locus_tag %in% joint_amr$locus_tag, "ARG", "-"))
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168)
genomic_features <- genomic_features %>%
left_join(campy_loctags, by="locus_tag")
# Adding pre-selected info to genomic features
salm.preselection <- read_tsv("data/pre_selected_salmonella.txt") %>%
rename("symbol"=ID) %>%
left_join(genomic_features, by="symbol") %>%
select(gene_name)
camp.preselection <- read_excel("data/Campy regulators and stress resp for Roberto.xlsx") %>%
rename("locus_tag" = `Locus tag 81-176`,
clone=`clone?`) %>%
mutate("gene_name" = paste0(locus_tag, "-Campylobacter"),
clone=if_else(is.na(clone), "No", "Yes"))
all_preselected <- c(salm.preselection$gene_name, camp.preselection$gene_name)
campy.clone <-  subset(camp.preselection, clone=="Yes")$gene_name
genomic_features <- genomic_features %>%
mutate("pre.selected" = if_else(gene_name %in% all_preselected, "Yes", "-"),
"campy.clone" = if_else(gene_name %in% campy.clone, "Yes", "-"))
complete_dataframe %>%
select(gene_name, symbol, locus_tag.NCTC11168, pre.selected,
pattern_id, campy.clone, n_genes, TF, tf_name, family, subtype) %>%
distinct()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
# Reading in genomic features
salm_features <- read_tsv("data/merged_features_salmonella.tsv") %>%
mutate(organism="Salmonella",
gene_name=paste0(locus_tag, "-Salmonella")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
camp_features <- read_tsv("data/merged_features_campylobacter.tsv") %>%
mutate(organism="Campylobacter",
gene_name=paste0(locus_tag, "-Campylobacter")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
genomic_features <- bind_rows(camp_features, salm_features)
# Reading TF info
camp_tf <- read_tsv("data/cjj_TFs.tsv")
salm_tf <- read_tsv("data/sey_TFs.tsv")
joint_tfs <- bind_rows(camp_tf, salm_tf) %>%
select(locus_tag, tf_name, family, subtype)
genomic_features <- genomic_features %>%
mutate("TF" = if_else(locus_tag %in% joint_tfs$locus_tag, "TF", "-"))
genomic_features <- genomic_features %>%
left_join(joint_tfs, by="locus_tag")
# Reading AMR
camp_amr <- read_tsv("data/cjj_AMR.tsv")
salm_amr <- read_tsv("data/sey_AMR.tsv")
joint_amr <- bind_rows(camp_amr, salm_amr)
genomic_features <- genomic_features %>%
mutate("ARG_gene" = if_else(locus_tag %in% joint_amr$locus_tag, "ARG", "-"))
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168)
campy_loctags
campy_loctags %>% distinct()
joint_tfs <- bind_rows(camp_tf, salm_tf) %>%
select(locus_tag, tf_name, family, subtype) %>%
distinct(.keep_all = T)
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168) %>%
distinct(.keep_all = T)
genomic_features <- genomic_features %>%
left_join(campy_loctags, by="locus_tag")
runApp()
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168) %>%
distinct(.keep_all = T)
campy_loctags
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168) %>%
distinct()
campy_loctags
campy_loctags
runApp()
campy_loctags %>%
count(locus_tag)
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168) %>%
count(locus_tag) %>%
arrage(desc(n))
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168) %>%
count(locus_tag) %>%
arrange(desc(n))
campy_loctags
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168) %>%
filter(locus_tag=="CJJ81176_0046")
campy_loctags
runApp()
runApp()
# Reading in genomic features
salm_features <- read_tsv("data/merged_features_salmonella.tsv") %>%
mutate(organism="Salmonella",
gene_name=paste0(locus_tag, "-Salmonella")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
camp_features <- read_tsv("data/merged_features_campylobacter.tsv") %>%
mutate(organism="Campylobacter",
gene_name=paste0(locus_tag, "-Campylobacter")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
genomic_features <- bind_rows(camp_features, salm_features)
library(tidyverse)
library(readxl)
# Reading in genomic features
salm_features <- read_tsv("data/merged_features_salmonella.tsv") %>%
mutate(organism="Salmonella",
gene_name=paste0(locus_tag, "-Salmonella")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
camp_features <- read_tsv("data/merged_features_campylobacter.tsv") %>%
mutate(organism="Campylobacter",
gene_name=paste0(locus_tag, "-Campylobacter")) %>%
select(gene_name, `# feature`, symbol, locus_tag)
genomic_features <- bind_rows(camp_features, salm_features)
genomic_features
# Reading TF info
camp_tf <- read_tsv("data/cjj_TFs.tsv")
salm_tf <- read_tsv("data/sey_TFs.tsv")
joint_tfs <- bind_rows(camp_tf, salm_tf) %>%
select(locus_tag, tf_name, family, subtype)
genomic_features <- genomic_features %>%
mutate("TF" = if_else(locus_tag %in% joint_tfs$locus_tag, "TF", "-"))
genomic_features <- genomic_features %>%
left_join(joint_tfs, by="locus_tag")
genomic_features
# Reading AMR
camp_amr <- read_tsv("data/cjj_AMR.tsv")
salm_amr <- read_tsv("data/sey_AMR.tsv")
joint_amr <- bind_rows(camp_amr, salm_amr)
genomic_features <- genomic_features %>%
mutate("ARG_gene" = if_else(locus_tag %in% joint_amr$locus_tag, "ARG", "-"))
genomic_features
# Adding Campy loctags
campy_loctags <- read_tsv("data/cje_cjj_loctags.tsv") %>%
rename(locus_tag = locus_tag.cjj,
locus_tag.NCTC11168 = locus_tag.cje) %>%
select(locus_tag, locus_tag.NCTC11168)
genomic_features <- genomic_features %>%
left_join(campy_loctags, by="locus_tag")
# Adding pre-selected info to genomic features
salm.preselection <- read_tsv("data/pre_selected_salmonella.txt") %>%
rename("symbol"=ID) %>%
left_join(genomic_features, by="symbol") %>%
select(gene_name)
camp.preselection <- read_excel("data/Campy regulators and stress resp for Roberto.xlsx") %>%
rename("locus_tag" = `Locus tag 81-176`,
clone=`clone?`) %>%
mutate("gene_name" = paste0(locus_tag, "-Campylobacter"),
clone=if_else(is.na(clone), "No", "Yes"))
all_preselected <- c(salm.preselection$gene_name, camp.preselection$gene_name)
campy.clone <-  subset(camp.preselection, clone=="Yes")$gene_name
genomic_features <- genomic_features %>%
mutate("pre.selected" = if_else(gene_name %in% all_preselected, "Yes", "-"),
"campy.clone" = if_else(gene_name %in% campy.clone, "Yes", "-")) %>%
select(-locus_tag)
genomic_features
shiny::runApp()
runApp()
